{
  "scopeName": "source.cddl",
  "patterns": [{ "include": "#expression" }],
  "repository": {
    "expression": {
      "patterns": [
        { "include": "#group-expression" },
        { "include": "#map-expression" },
        { "include": "#array-expression" },
        { "include": "#range-control-operator" },
        { "include": "#socketplug" },
        { "include": "#ruleidentifier" },
        { "include": "#standard-prelude" },
        { "include": "#comments" },
        { "include": "#literal-text-string" },
        { "include": "#literal-byte-string" },
        { "include": "#choiceseparator" },
        { "include": "#occurrence" }
      ]
    },
    "group-expression": {
      "begin": "\\(",
      "end": "\\)",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.group.begin.cddl" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.group.end.cddl" }
      },
      "name": "meta.structure.group.cddl",
      "patterns": [{ "include": "#expression" }]
    },
    "map-expression": {
      "begin": "\\{",
      "end": "\\}",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.map.begin.cddl" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.map.end.cddl" }
      },
      "name": "meta.structure.map.cddl",
      "patterns": [{ "include": "#expression" }]
    },
    "array-expression": {
      "begin": "\\[",
      "end": "\\]",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.array.begin.cddl" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.array.end.cddl" }
      },
      "name": "meta.structure.array.cddl",
      "patterns": [{ "include": "#expression" }]
    },
    "range-control-operator": {
      "match": "\\.\\.\\.|\\.\\.|\\.size|\\.bits|\\.regex|\\.pcre|\\.cbor|\\.cborseq|\\.within|\\.and|\\.lt|\\.le|\\.gt|\\.ge|\\.eq|\\.ne|\\.default",
      "name": "keyword.operator.cddl"
    },
    "standard-prelude": {
      "match": "\\b^any$|\\binteger|\\buint|\\bnint|\\bint|\\bbstr|\\bbytes|\\btstr|\\btext|\\btdate|\\btime|\\bnumber|\\bbiguint|\\bbignint|\\bbigint|\\bunsigned|\\bdecfrac|\\bbigfloat|\\beb64url|\\beb64legacy|\\beb16|\\bencoded\\-cbor|\\b^uri$|\\bb64url|\\bb64legacy|\\bregexp|\\bmime\\-message|\\bcbor\\-any|\\bfloat16|\\bfloat32|\\bfloat64|\\bfloat16\\-32|\\bfloat32\\-64|\\bfloat|\\bfalse|\\btrue|\\bbool|\\bnil|\\bnull|\\bundefined",
      "name": "keyword.standard-prelude.cddl"
    },
    "comments": {
      "match": "(;).*$\\n?",
      "name": "comment.line.cddl",
      "captures": {
        "1": {
          "name": "punctuation.definition.comment.cddl"
        }
      }
    },
    "literal-text-string": {
      "name": "string.quoted.double.cddl",
      "begin": "\"",
      "beginCaputres": {
        "0": {
          "name": "punctuation.definition.string.begin.cddl"
        }
      },
      "end": "\"",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.cddl"
        }
      },
      "patterns": [{ "include": "#stringcontent" }]
    },
    "literal-byte-string": {
      "name": "string.quoted.single.cddl",
      "begin": "(b64|h)?'",
      "beginCaputres": {
        "0": {
          "name": "punctuation.definition.string.begin.cddl"
        }
      },
      "end": "'",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.cddl"
        }
      },
      "patterns": [{ "include": "#stringcontent" }]
    },
    "stringcontent": {
      "patterns": [
        {
          "match": "(?x)                # turn on extended mode\n  \\\\                # a literal backslash\n  (?:               # ...followed by...\n    [\"\\\\/bfnrt]     # one of these characters\n    |               # ...or...\n    u               # a u\n    [0-9a-fA-F]{4}) # and four hex digits",
          "name": "constant.character.escape.cddl"
        },
        {
          "match": "\\\\.",
          "name": "invalid.illegal.unrecognized-string-escape.cddl"
        }
      ]
    },
    "socketplug": {
      "name": "keyword.operator.cddl",
      "match": "\\$\\$|\\$"
    },
    "ruleidentifier": {
      "name": "variable.cddl",
      "match": "(\\w|@|\\$)+((-|\\.)*(\\w|@|\\$|\\d))*(?=(<\\w+(,\\s*\\w+)*>)?\\s*(=(?!>)|//=|/=))"
    },
    "choiceseparator": {
      "name": "punctuation.separator.choice.cddl",
      "match": "/|//"
    },
    "occurrence": {
      "name": "keyword.operator.cddl",
      "match": "\\?|\\+|\\d?\\*\\d?"
    }
  }
}
